{"title":"Elasticsearch关于 REST API的使用介绍","uid":"e6af55037cba3fe2cceb0e9fb27dac27","slug":"Elasticsearch关于 REST API的使用介绍","date":"2022-02-16T06:04:40.000Z","updated":"2022-02-16T09:42:21.967Z","comments":true,"path":"api/articles/Elasticsearch关于 REST API的使用介绍.json","keywords":null,"cover":"/post/Elasticsearch关于 REST API的使用介绍/cover.jpeg","content":"<p>Elasticsearch提供了大量的REST api来集成、查询和管理数据。下面将在这篇文章中介绍一些经常使用的REST API。</p>\n<hr>\n<h3 id=\"一、集群健康\"><a href=\"#一、集群健康\" class=\"headerlink\" title=\"一、集群健康\"></a>一、集群健康</h3><p><a href=\"https://www.elastic.co/guide/cn/elasticsearch/guide/current/_cluster_health.html\">集群健康 | Elasticsearch: 权威指南 | Elastic</a></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">GET &#x2F;_cluster&#x2F;health</code></pre>\n\n<p>和 Elasticsearch 里其他 API 一样，<code>cluster-health</code> 会返回一个 JSON 响应。这对自动化和告警系统来说，非常便于解析。响应中包含了和你集群有关的一些关键信息：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;cluster_name&quot;: &quot;joker-elasticsearch&quot;,\n    &quot;status&quot;: &quot;yellow&quot;,\n    &quot;timed_out&quot;: false,\n    &quot;number_of_nodes&quot;: 1,\n    &quot;number_of_data_nodes&quot;: 1,\n    &quot;active_primary_shards&quot;: 8,\n    &quot;active_shards&quot;: 8,\n    &quot;relocating_shards&quot;: 0,\n    &quot;initializing_shards&quot;: 0,\n    &quot;unassigned_shards&quot;: 3,\n    &quot;delayed_unassigned_shards&quot;: 0,\n    &quot;number_of_pending_tasks&quot;: 0,\n    &quot;number_of_in_flight_fetch&quot;: 0,\n    &quot;task_max_waiting_in_queue_millis&quot;: 0,\n    &quot;active_shards_percent_as_number&quot;: 72.72727272727273\n&#125;</code></pre>\n\n<p>响应信息中最重要的一块就是 <code>status</code> 字段。状态可能是下列三个值之一：</p>\n<p><strong><code>green</code></strong></p>\n<p>所有的主分片和副本分片都已分配。你的集群是 100% 可用的。</p>\n<p><strong><code>yellow</code></strong></p>\n<p>所有的主分片已经分片了，但至少还有一个副本是缺失的。不会有数据丢失，所以搜索结果依然是完整的。不过，你的高可用性在某种程度上被弱化。如果 <em>更多的</em> 分片消失，你就会丢数据了。把 <code>yellow</code> 想象成一个需要及时调查的警告。</p>\n<p><strong><code>red</code></strong></p>\n<p>至少一个主分片（以及它的全部副本）都在缺失中。这意味着你在缺少数据：搜索只能返回部分数据，而分配到这个分片上的写入请求会返回一个异常。</p>\n<p><code>green</code>/<code>yellow</code>/<code>red</code> 状态是一个概览你的集群并了解眼下正在发生什么的好办法。剩下来的指标给你列出来集群的状态概要：</p>\n<ul>\n<li><code>number_of_nodes</code> 和 <code>number_of_data_nodes</code> 这个命名完全是自描述的。</li>\n<li><code>active_primary_shards</code> 指出你集群中的主分片数量。这是涵盖了所有索引的汇总值。</li>\n<li><code>active_shards</code> 是涵盖了所有索引的_所有_分片的汇总值，即包括副本分片。</li>\n<li><code>relocating_shards</code> 显示当前正在从一个节点迁往其他节点的分片的数量。通常来说应该是 0，不过在 Elasticsearch 发现集群不太均衡时，该值会上涨。比如说：添加了一个新节点，或者下线了一个节点。</li>\n<li><code>initializing_shards</code> 是刚刚创建的分片的个数。比如，当你刚创建第一个索引，分片都会短暂的处于 <code>initializing</code> 状态。这通常会是一个临时事件，分片不应该长期停留在 <code>initializing</code> 状态。你还可能在节点刚重启的时候看到 <code>initializing</code> 分片：当分片从磁盘上加载后，它们会从 <code>initializing</code> 状态开始。</li>\n<li><code>unassigned_shards</code> 是已经在集群状态中存在的分片，但是实际在集群里又找不着。通常未分配分片的来源是未分配的副本。比如，一个有 5 分片和 1 副本的索引，在单节点集群上，就会有 5 个未分配副本分片。如果你的集群是 <code>red</code> 状态，也会长期保有未分配分片（因为缺少主分片）。</li>\n</ul>\n<h3 id=\"二、索引相关\"><a href=\"#二、索引相关\" class=\"headerlink\" title=\"二、索引相关\"></a>二、索引相关</h3><h4 id=\"2-1-创建索引\"><a href=\"#2-1-创建索引\" class=\"headerlink\" title=\"2.1 创建索引\"></a>2.1 创建索引</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">PUT &#x2F;index_demo\n&#123;\n    &quot;settings&quot;: &#123;\n        &quot;index&quot;: &#123;\n            &quot;number_of_shards&quot;: &quot;2&quot;,\n            &quot;number_of_replicas&quot;: &quot;0&quot;\n        &#125;\n    &#125;\n&#125;</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>number_of_shards : 分片数</li>\n<li>number_of_replicas : 副本数</li>\n</ul></blockquote>\n<h4 id=\"2-2-删除索引\"><a href=\"#2-2-删除索引\" class=\"headerlink\" title=\"2.2 删除索引\"></a>2.2 删除索引</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">DELETE &#x2F;index_demo</code></pre>\n\n<h4 id=\"2-3-查看索引\"><a href=\"#2-3-查看索引\" class=\"headerlink\" title=\"2.3 查看索引\"></a>2.3 查看索引</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">GET &#x2F;_cat&#x2F;indices?v</code></pre>\n\n<h3 id=\"三、mappings-自定义创建映射\"><a href=\"#三、mappings-自定义创建映射\" class=\"headerlink\" title=\"三、mappings 自定义创建映射\"></a>三、mappings 自定义创建映射</h3><h4 id=\"3-1-创建索引的同时创建mappings\"><a href=\"#3-1-创建索引的同时创建mappings\" class=\"headerlink\" title=\"3.1 创建索引的同时创建mappings\"></a>3.1 创建索引的同时创建mappings</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">PUT &#x2F;index_mappings\n&#123;\n    &quot;settings&quot;: &#123;\n        &quot;index&quot;: &#123;\n            &quot;number_of_shards&quot;: &quot;3&quot;,\n            &quot;number_of_replicas&quot;: &quot;0&quot;\n        &#125;\n    &#125;,\n    &quot;mappings&quot;: &#123;\n        &quot;properties&quot;: &#123;\n            &quot;realname&quot;: &#123;\n            \t&quot;type&quot;: &quot;text&quot;,\n            \t&quot;index&quot;: true\n            &#125;,\n            &quot;username&quot;: &#123;\n            \t&quot;type&quot;: &quot;keyword&quot;,\n            \t&quot;index&quot;: false\n            &#125;,\n            &quot;id&quot;: &#123;\n        \t    &quot;type&quot;: &quot;long&quot;\n            &#125;,\n            &quot;age&quot;: &#123;\n            \t&quot;type&quot;: &quot;integer&quot;\n            &#125;,\n            &quot;nickname&quot;: &#123;\n                &quot;type&quot;: &quot;keyword&quot;\n            &#125;,\n            &quot;money1&quot;: &#123;\n                &quot;type&quot;: &quot;float&quot;\n            &#125;,\n            &quot;money2&quot;: &#123;\n                &quot;type&quot;: &quot;double&quot;\n            &#125;,\n            &quot;sex&quot;: &#123;\n                &quot;type&quot;: &quot;byte&quot;\n            &#125;,\n            &quot;score&quot;: &#123;\n                &quot;type&quot;: &quot;short&quot;\n            &#125;,\n            &quot;is_teenager&quot;: &#123;\n                &quot;type&quot;: &quot;boolean&quot;\n            &#125;,\n            &quot;birthday&quot;: &#123;\n                &quot;type&quot;: &quot;date&quot;\n            &#125;,\n            &quot;relationship&quot;: &#123;\n                &quot;type&quot;: &quot;object&quot;\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li><strong>number_of_shards</strong> : 分片数</li>\n<li><strong>number_of_replicas</strong> : 副本数</li>\n<li><strong>index</strong>：默认true，设置为false的话，那么这个字段就不会被索引(例如密码等敏感信息)</li>\n<li>某个属性一旦被建立，就不能修改了，但是可以新增额外属性</li>\n<li>主要数据类型：</li>\n<li>text, keyword, <del>string</del></li>\n<li>long, integer, short, byte</li>\n<li>double, float</li>\n<li>boolean</li>\n<li>date</li>\n<li>object</li>\n<li>数组不能混，类型一致</li>\n<li><strong>text</strong>：文字类需要被分词被倒排索引的内容，比如<code>商品名称</code>，<code>商品详情</code>，<code>商品介绍</code>，使用text。</li>\n<li><strong>keyword</strong>：不会被分词，不会被倒排索引，直接匹配搜索，比如<code>订单状态</code>，<code>用户qq</code>，<code>微信号</code>，<code>手机号</code>等，这些精确匹配，无需分词。</li>\n</ul></blockquote>\n<h3 id=\"四、文档的基本操作\"><a href=\"#四、文档的基本操作\" class=\"headerlink\" title=\"四、文档的基本操作\"></a>四、文档的基本操作</h3><h4 id=\"4-1-添加文档\"><a href=\"#4-1-添加文档\" class=\"headerlink\" title=\"4.1 添加文档\"></a>4.1 添加文档</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">POST &#x2F;&#123;索引名&#125;&#x2F;_doc&#x2F;&#123;索引ID&#125;（是指索引在es中的id，而不是这条记录的id，比如记录的id从数据库来是1001，并不是这个。如果不写，则自动生成一个字符串。建议和数据id保持一致&gt; ）\n\nPOST &#x2F;index_doc&#x2F;_doc&#x2F;1\n&#123;\n    &quot;id&quot;: 1001,\n    &quot;username&quot;: &quot;username1&quot;,\n    &quot;password&quot;: &quot;password1&quot;,\n    &quot;create_date&quot;: &quot;2021-01-09&quot;\n&#125;</code></pre>\n\n<h5 id=\"查看索引\"><a href=\"#查看索引\" class=\"headerlink\" title=\"查看索引\"></a>查看索引</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">GET &#x2F;index_doc</code></pre>\n\n<h5 id=\"返回结果\"><a href=\"#返回结果\" class=\"headerlink\" title=\"返回结果\"></a>返回结果</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;index_doc&quot;: &#123;\n        &quot;aliases&quot;: &#123;&#125;,\n        &quot;mappings&quot;: &#123;\n            &quot;properties&quot;: &#123;\n                &quot;create_date&quot;: &#123;\n                    &quot;type&quot;: &quot;date&quot;\n                &#125;,\n                &quot;id&quot;: &#123;\n                    &quot;type&quot;: &quot;long&quot;\n                &#125;,\n                &quot;password&quot;: &#123;\n                    &quot;type&quot;: &quot;text&quot;,\n                    &quot;fields&quot;: &#123;\n                        &quot;keyword&quot;: &#123;\n                            &quot;type&quot;: &quot;keyword&quot;,\n                            &quot;ignore_above&quot;: 256\n                        &#125;\n                    &#125;\n                &#125;,\n                &quot;username&quot;: &#123;\n                    &quot;type&quot;: &quot;text&quot;,\n                    &quot;fields&quot;: &#123;\n                        &quot;keyword&quot;: &#123;\n                            &quot;type&quot;: &quot;keyword&quot;,\n                            &quot;ignore_above&quot;: 256\n                        &#125;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;,\n        &quot;settings&quot;: &#123;\n            &quot;index&quot;: &#123;\n                &quot;creation_date&quot;: &quot;1644999567382&quot;,\n                &quot;number_of_shards&quot;: &quot;3&quot;,\n                &quot;number_of_replicas&quot;: &quot;0&quot;,\n                &quot;uuid&quot;: &quot;k3O8-AHVRMuM0KTrJ9q0ww&quot;,\n                &quot;version&quot;: &#123;\n                    &quot;created&quot;: &quot;7040299&quot;\n                &#125;,\n                &quot;provided_name&quot;: &quot;index_doc&quot;\n            &#125;\n        &#125;\n    &#125;\n&#125;</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>注意</strong>：</p>\n<ul>\n<li>如果索引没有手动建立mappings，那么当插入文档数据的时候，会根据文档类型自动设置属性类型。这个就是es的动态映射，帮我们在index索引库中去建立数据结构的相关配置信息。</li>\n<li>“fields”: {“type”: “keyword”}对一个字段设置多种索引模式，使用text类型做全文检索，也可使用keyword类型做聚合和排序</li>\n<li>“ignore_above” : 256设置字段索引和存储的长度最大值，超过则被忽略</li>\n</ul></blockquote>\n<h4 id=\"4-2-修改文档\"><a href=\"#4-2-修改文档\" class=\"headerlink\" title=\"4.2 修改文档\"></a>4.2 修改文档</h4><h5 id=\"4-2-1-局部修改\"><a href=\"#4-2-1-局部修改\" class=\"headerlink\" title=\"4.2.1 局部修改\"></a>4.2.1 局部修改</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">POST &#x2F;index_doc&#x2F;_doc&#x2F;1&#x2F;_update\n&#123;\n    &quot;doc&quot;: &#123;\n        &quot;name&quot;: &quot;update1&quot;\n    &#125;\n&#125;</code></pre>\n\n<h5 id=\"4-2-2-全局修改\"><a href=\"#4-2-2-全局修改\" class=\"headerlink\" title=\"4.2.2 全局修改\"></a>4.2.2 全局修改</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">PUT &#x2F;index_doc&#x2F;_doc&#x2F;1\n&#123;\n    &quot;id&quot;: 1,\n    &quot;username&quot;: &quot;update2&quot;,\n    &quot;password&quot;: &quot;password1&quot;,\n    &quot;create_date&quot;: &quot;2021-01-09&quot;\n&#125;</code></pre>\n\n<p>同时每次修改后，返回参数中的属性 <code>verison</code> 都会更改</p>\n<h4 id=\"4-3-删除文档\"><a href=\"#4-3-删除文档\" class=\"headerlink\" title=\"4.3 删除文档\"></a>4.3 删除文档</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">DELETE &#x2F;index_doc&#x2F;_doc&#x2F;1</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>注</strong>：文档删除不是立即删除，文档还是保存在磁盘上，索引增长越来越多，才会把那些曾经标识过删除的，进行清理，从磁盘上移出去。</p></blockquote>\n<h4 id=\"4-4-查询文档\"><a href=\"#4-4-查询文档\" class=\"headerlink\" title=\"4.4 查询文档\"></a>4.4 查询文档</h4><h5 id=\"4-4-1-常规查询\"><a href=\"#4-4-1-常规查询\" class=\"headerlink\" title=\"4.4.1 常规查询\"></a>4.4.1 常规查询</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">GET &#x2F;index_doc&#x2F;_doc&#x2F;&#123;索引ID&#125;\nGET &#x2F;index_doc&#x2F;_doc&#x2F;_search</code></pre>\n\n<h5 id=\"4-4-2-元数据\"><a href=\"#4-4-2-元数据\" class=\"headerlink\" title=\"4.4.2 元数据\"></a>4.4.2 元数据</h5><ul>\n<li>_index：文档数据所属那个索引，理解为数据库的某张表即可。</li>\n<li>_type：文档数据属于哪个类型，新版本使用<code>_doc</code> 。</li>\n<li>_id：文档数据的唯一标识，类似数据库中某张表的主键。可以自动生成或者手动指定。</li>\n<li>_score：查询相关度，是否契合用户匹配，分数越高用户的搜索体验越高。</li>\n<li>_version：版本号。</li>\n<li>_source：文档数据，json格式。</li>\n</ul>\n<h5 id=\"4-4-3-定制结果集\"><a href=\"#4-4-3-定制结果集\" class=\"headerlink\" title=\"4.4.3 定制结果集\"></a>4.4.3 定制结果集</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">GET &#x2F;index_doc&#x2F;_doc&#x2F;&#123;索引ID&#125;?_source&#x3D;&#123;属性1&#125;,&#123;属性1&#125;...\nGET &#x2F;index_doc&#x2F;_doc&#x2F;_search?_source&#x3D;&#123;属性1&#125;,&#123;属性1&#125;...</code></pre>\n\n<h5 id=\"4-4-4-判断文档是否存在\"><a href=\"#4-4-4-判断文档是否存在\" class=\"headerlink\" title=\"4.4.4 判断文档是否存在\"></a>4.4.4 判断文档是否存在</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">HEAD &#x2F;index_doc&#x2F;_doc&#x2F;&#123;索引ID&#125;</code></pre>\n\n","feature":true,"text":"Elasticsearch提供了大量的REST api来集成、查询和管理数据。下面将在这篇文章中介绍一些经常使用的REST API。 一、集群健康集群健康 | Elasticsearch: 权威指南 | Elastic GET &#x2F;_cluster&#x2F;health...","link":"","photos":[],"count_time":{"symbolsCount":"8k","symbolsTime":"7 mins."},"categories":[{"name":"ELK","slug":"ELK","count":2,"path":"api/categories/ELK.json"}],"tags":[{"name":"Elasticsearch","slug":"Elasticsearch","count":2,"path":"api/tags/Elasticsearch.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%80%E3%80%81%E9%9B%86%E7%BE%A4%E5%81%A5%E5%BA%B7\"><span class=\"toc-text\">一、集群健康</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BA%8C%E3%80%81%E7%B4%A2%E5%BC%95%E7%9B%B8%E5%85%B3\"><span class=\"toc-text\">二、索引相关</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-1-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">2.1 创建索引</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-2-%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">2.2 删除索引</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-3-%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">2.3 查看索引</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%89%E3%80%81mappings-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84\"><span class=\"toc-text\">三、mappings 自定义创建映射</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-1-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95%E7%9A%84%E5%90%8C%E6%97%B6%E5%88%9B%E5%BB%BAmappings\"><span class=\"toc-text\">3.1 创建索引的同时创建mappings</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9B%9B%E3%80%81%E6%96%87%E6%A1%A3%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">四、文档的基本操作</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-1-%E6%B7%BB%E5%8A%A0%E6%96%87%E6%A1%A3\"><span class=\"toc-text\">4.1 添加文档</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">查看索引</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C\"><span class=\"toc-text\">返回结果</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-2-%E4%BF%AE%E6%94%B9%E6%96%87%E6%A1%A3\"><span class=\"toc-text\">4.2 修改文档</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-2-1-%E5%B1%80%E9%83%A8%E4%BF%AE%E6%94%B9\"><span class=\"toc-text\">4.2.1 局部修改</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-2-2-%E5%85%A8%E5%B1%80%E4%BF%AE%E6%94%B9\"><span class=\"toc-text\">4.2.2 全局修改</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-3-%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3\"><span class=\"toc-text\">4.3 删除文档</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-4-%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3\"><span class=\"toc-text\">4.4 查询文档</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-1-%E5%B8%B8%E8%A7%84%E6%9F%A5%E8%AF%A2\"><span class=\"toc-text\">4.4.1 常规查询</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-2-%E5%85%83%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">4.4.2 元数据</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-3-%E5%AE%9A%E5%88%B6%E7%BB%93%E6%9E%9C%E9%9B%86\"><span class=\"toc-text\">4.4.3 定制结果集</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4-4-4-%E5%88%A4%E6%96%AD%E6%96%87%E6%A1%A3%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8\"><span class=\"toc-text\">4.4.4 判断文档是否存在</span></a></li></ol></li></ol></li></ol>","author":{"name":"Joker","slug":"blog-author","avatar":"/images/avatar.jpeg","link":"/","description":"世界上只有一种真正的英雄主义，就是认清了生活的真相后还依然热爱它<br>即刻开始,从现在开始<br>Just Do It！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"Elasticsearch的介绍与安装","uid":"7e9c0ed522e9f463cbadca3b64226a03","slug":"Elasticsearch的介绍与安装","date":"2022-01-18T03:05:24.000Z","updated":"2022-01-18T08:30:45.349Z","comments":true,"path":"api/articles/Elasticsearch的介绍与安装.json","keywords":null,"cover":"/post/Elasticsearch的介绍与安装/cover.jpeg","text":"Elasticsearch是一个分布式的开源搜索和分析引擎，适用于所有类型的数据，包括文本、数字、地理空间、结构化和非结构化数据。Elasticsearch是在Lucene的基础上开发而成，由Elasticsearch N.V(即现在的Elastic)于2010年首次发布。Ela...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"ELK","slug":"ELK","count":2,"path":"api/categories/ELK.json"}],"tags":[{"name":"Elasticsearch","slug":"Elasticsearch","count":2,"path":"api/tags/Elasticsearch.json"}],"author":{"name":"Joker","slug":"blog-author","avatar":"/images/avatar.jpeg","link":"/","description":"世界上只有一种真正的英雄主义，就是认清了生活的真相后还依然热爱它<br>即刻开始,从现在开始<br>Just Do It！","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}